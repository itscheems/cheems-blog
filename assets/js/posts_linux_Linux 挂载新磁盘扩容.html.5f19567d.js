"use strict";(self.webpackChunkcjayjay_blog=self.webpackChunkcjayjay_blog||[]).push([[645],{6262:(s,n)=>{n.A=(s,n)=>{const a=s.__vccOpts||s;for(const[s,i]of n)a[s]=i;return a}},5591:(s,n,a)=>{a.r(n),a.d(n,{comp:()=>l,data:()=>d});var i=a(641);const e={},l=(0,a(6262).A)(e,[["render",function(s,n){return(0,i.uX)(),(0,i.CE)("div",null,n[0]||(n[0]=[(0,i.Fv)('<p>我给 Ubuntu 添加了一块 8G 的硬盘，但新添加的硬盘还不能直接使用，还需要将硬盘进行初始化操作。初始化操作通常包含以下步骤</p><h2 id="确认新设备存在" tabindex="-1"><a class="header-anchor" href="#确认新设备存在"><span>确认新设备存在</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lsblk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>观察发现，<code>nvme0n2</code> 就是我新添加的 8G 的盘</p><p>output:</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:~$ sudo lsblk</span></span>\n<span class="line"><span>NAME                      MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span></span>\n<span class="line"><span>loop0                       7:0    0  55.4M  1 loop /snap/aws-cli/1424</span></span>\n<span class="line"><span>loop1                       7:1    0  48.8M  1 loop /snap/core18/2857</span></span>\n<span class="line"><span>loop2                       7:2    0  55.5M  1 loop /snap/aws-cli/1430</span></span>\n<span class="line"><span>loop3                       7:3    0  59.5M  1 loop /snap/core20/2503</span></span>\n<span class="line"><span>loop4                       7:4    0  68.9M  1 loop /snap/core22/1912</span></span>\n<span class="line"><span>loop5                       7:5    0  68.9M  1 loop /snap/core22/1966</span></span>\n<span class="line"><span>loop6                       7:6    0 115.8M  1 loop /snap/docker/3065</span></span>\n<span class="line"><span>loop7                       7:7    0  17.8M  1 loop /snap/etcd/228</span></span>\n<span class="line"><span>loop8                       7:8    0  70.3M  1 loop /snap/kata-containers/2048</span></span>\n<span class="line"><span>loop9                       7:9    0  44.3M  1 loop /snap/snapd/24509</span></span>\n<span class="line"><span>loop10                      7:10   0  21.9M  1 loop /snap/keepalived/3057</span></span>\n<span class="line"><span>loop11                      7:11   0  38.7M  1 loop /snap/snapd/23772</span></span>\n<span class="line"><span>sr0                        11:0    1   2.7G  0 rom</span></span>\n<span class="line"><span>nvme0n1                   259:0    0    70G  0 disk</span></span>\n<span class="line"><span>├─nvme0n1p1               259:1    0     1G  0 part /boot/efi</span></span>\n<span class="line"><span>├─nvme0n1p2               259:2    0     2G  0 part /boot</span></span>\n<span class="line"><span>└─nvme0n1p3               259:3    0  66.9G  0 part</span></span>\n<span class="line"><span>  └─ubuntu--vg-ubuntu--lv 252:0    0  33.5G  0 lvm  /</span></span>\n<span class="line"><span>nvme0n2                   259:4    0     8G  0 disk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>并且能在 <code>/dev</code> 下能看见这个驱动，通过输出可以看见 <code>nvme0n2</code> 设备</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:~$ ll /dev | grep nvme0n</span></span>\n<span class="line"><span>brw-rw----   1 root disk    259,   0 May  4 16:25 nvme0n1</span></span>\n<span class="line"><span>brw-rw----   1 root disk    259,   1 May  4 16:25 nvme0n1p1</span></span>\n<span class="line"><span>brw-rw----   1 root disk    259,   2 May  4 16:25 nvme0n1p2</span></span>\n<span class="line"><span>brw-rw----   1 root disk    259,   3 May  4 16:25 nvme0n1p3</span></span>\n<span class="line"><span>brw-rw----   1 root disk    259,   4 May  4 16:25 nvme0n2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="分区-针对-2tb-以内的硬盘-mbr分区" tabindex="-1"><a class="header-anchor" href="#分区-针对-2tb-以内的硬盘-mbr分区"><span>分区 - 针对 2TB 以内的硬盘 (MBR分区)</span></a></h2><p>使用 fdisk 工具来分区</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fdisk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/nvme0n2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>进入 fdisk 工具会显示如下界面，键盘按下 &quot;m&quot; 键回车，查看帮助</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:~$ sudo fdisk /dev/nvme0n2</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>Welcome to fdisk (util-linux 2.39.3).</span></span>\n<span class="line"><span>Changes will remain in memory only, until you decide to write them.</span></span>\n<span class="line"><span>Be careful before using the write command.</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>Device does not contain a recognized partition table.</span></span>\n<span class="line"><span>Created a new DOS (MBR) disklabel with disk identifier 0x63381d6a.</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>Command (m for help):</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 Generic 部分，按下 &quot;n&quot; 键回车，创建新分区</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>  Generic</span></span>\n<span class="line"><span>   d   delete a partition</span></span>\n<span class="line"><span>   F   list free unpartitioned space</span></span>\n<span class="line"><span>   l   list known partition types</span></span>\n<span class="line"><span>   n   add a new partition</span></span>\n<span class="line"><span>   p   print the partition table</span></span>\n<span class="line"><span>   t   change a partition type</span></span>\n<span class="line"><span>   v   verify the partition table</span></span>\n<span class="line"><span>   i   print information about a partition</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>选择分区类型，主分区，默认也是主分区，所以按 &quot;p&quot;，或直接回车。</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Command (m for help): n</span></span>\n<span class="line"><span>Partition type</span></span>\n<span class="line"><span>   p   primary (0 primary, 0 extended, 4 free)</span></span>\n<span class="line"><span>   e   extended (container for logical partitions)</span></span>\n<span class="line"><span>Select (default p):</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>设置分区号，默认 1</li><li>设置扇区起始位置，直接回车（2048）</li><li>设置扇区范围，直接回车（2048-16777215, default 16777215） 设置完毕，回到了起始位置</li></ul><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Command (m for help): n</span></span>\n<span class="line"><span>Partition type</span></span>\n<span class="line"><span>   p   primary (0 primary, 0 extended, 4 free)</span></span>\n<span class="line"><span>   e   extended (container for logical partitions)</span></span>\n<span class="line"><span>Select (default p): p</span></span>\n<span class="line"><span>Partition number (1-4, default 1): 1</span></span>\n<span class="line"><span>First sector (2048-16777215, default 2048):</span></span>\n<span class="line"><span>Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-16777215, default 16777215):</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>Created a new partition 1 of type &#39;Linux&#39; and of size 8 GiB.</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>Command (m for help):</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>按下 &quot;w&quot; 回车，保存并退出</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>  Save &amp; Exit</span></span>\n<span class="line"><span>   w   write table to disk and exit</span></span>\n<span class="line"><span>   q   quit without saving changes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Command (m for help): w</span></span>\n<span class="line"><span>The partition table has been altered.</span></span>\n<span class="line"><span>Calling ioctl() to re-read partition table.</span></span>\n<span class="line"><span>Syncing disks.</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>jojo@jojo-server:~$</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="分区-针对-2tb的硬盘-gpt分区" tabindex="-1"><a class="header-anchor" href="#分区-针对-2tb的硬盘-gpt分区"><span>分区 - 针对＞2TB的硬盘 (GPT分区)</span></a></h2><p>TODO</p><h2 id="格式化分区" tabindex="-1"><a class="header-anchor" href="#格式化分区"><span>格式化分区</span></a></h2><p>分区完成的状态</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:~$ sudo lsblk</span></span>\n<span class="line"><span>NAME                      MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span></span>\n<span class="line"><span>loop0                       7:0    0  55.4M  1 loop /snap/aws-cli/1424</span></span>\n<span class="line"><span>loop1                       7:1    0  48.8M  1 loop /snap/core18/2857</span></span>\n<span class="line"><span>loop2                       7:2    0  55.5M  1 loop /snap/aws-cli/1430</span></span>\n<span class="line"><span>loop3                       7:3    0  59.5M  1 loop /snap/core20/2503</span></span>\n<span class="line"><span>loop4                       7:4    0  68.9M  1 loop /snap/core22/1912</span></span>\n<span class="line"><span>loop5                       7:5    0  68.9M  1 loop /snap/core22/1966</span></span>\n<span class="line"><span>loop6                       7:6    0 115.8M  1 loop /snap/docker/3065</span></span>\n<span class="line"><span>loop7                       7:7    0  17.8M  1 loop /snap/etcd/228</span></span>\n<span class="line"><span>loop8                       7:8    0  70.3M  1 loop /snap/kata-containers/2048</span></span>\n<span class="line"><span>loop9                       7:9    0  44.3M  1 loop /snap/snapd/24509</span></span>\n<span class="line"><span>loop10                      7:10   0  21.9M  1 loop /snap/keepalived/3057</span></span>\n<span class="line"><span>loop11                      7:11   0  38.7M  1 loop /snap/snapd/23772</span></span>\n<span class="line"><span>sr0                        11:0    1   2.7G  0 rom</span></span>\n<span class="line"><span>nvme0n1                   259:0    0    70G  0 disk</span></span>\n<span class="line"><span>├─nvme0n1p1               259:1    0     1G  0 part /boot/efi</span></span>\n<span class="line"><span>├─nvme0n1p2               259:2    0     2G  0 part /boot</span></span>\n<span class="line"><span>└─nvme0n1p3               259:3    0  66.9G  0 part</span></span>\n<span class="line"><span>  └─ubuntu--vg-ubuntu--lv 252:0    0  33.5G  0 lvm  /</span></span>\n<span class="line"><span>nvme0n2                   259:4    0     8G  0 disk</span></span>\n<span class="line"><span>└─nvme0n2p1               259:6    0     8G  0 part</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们还得<strong>对分区</strong>进行格式化操作，将硬盘格式化成 ext4 文件系统</p><blockquote><p>注意：是对分区进行格式化，而不是对整块磁盘设备格式化，对磁盘格式化会覆盖分区表，导致分区信息丢失</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.ext4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/nvme0n2p1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>分区 UUID：9d763068-69d8-43f5-a334-87b289d0de9d</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:/$ sudo mkfs.ext4 /dev/nvme0n2p1</span></span>\n<span class="line"><span>mke2fs 1.47.0 (5-Feb-2023)</span></span>\n<span class="line"><span>Creating filesystem with 2096896 4k blocks and 524288 inodes</span></span>\n<span class="line"><span>Filesystem UUID: 9d763068-69d8-43f5-a334-87b289d0de9d</span></span>\n<span class="line"><span>Superblock backups stored on blocks:</span></span>\n<span class="line"><span>\t32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>Allocating group tables: done</span></span>\n<span class="line"><span>Writing inode tables: done</span></span>\n<span class="line"><span>Creating journal (16384 blocks): done</span></span>\n<span class="line"><span>Writing superblocks and filesystem accounting information: done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:~$ sudo lsblk</span></span>\n<span class="line"><span>NAME                      MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span></span>\n<span class="line"><span>...</span></span>\n<span class="line"><span>...</span></span>\n<span class="line"><span>nvme0n1                   259:0    0    70G  0 disk</span></span>\n<span class="line"><span>├─nvme0n1p1               259:1    0     1G  0 part /boot/efi</span></span>\n<span class="line"><span>├─nvme0n1p2               259:2    0     2G  0 part /boot</span></span>\n<span class="line"><span>└─nvme0n1p3               259:3    0  66.9G  0 part</span></span>\n<span class="line"><span>  └─ubuntu--vg-ubuntu--lv 252:0    0  33.5G  0 lvm  /</span></span>\n<span class="line"><span>nvme0n2                   259:4    0     8G  0 disk</span></span>\n<span class="line"><span>└─nvme0n2p1               259:5    0     8G  0 part</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="挂载与开机自动加载" tabindex="-1"><a class="header-anchor" href="#挂载与开机自动加载"><span>挂载与开机自动加载</span></a></h2><p>挂载点一般有 <code>/mnt</code> 和 <code>/data</code></p><ul><li><code>/mnt</code>：Linux系统中​<strong>​临时挂载​</strong>​的传统目录，通常用于手动挂载临时设备（USB驱动器、光盘等）。挂载到<code>/mnt</code>的设备通常不需要长期保留，重启后可能需要重新挂载</li><li><code>/data</code>：用户​<strong>​自定义的挂载点​</strong>​，通常用于​<strong>​长期存储​</strong>​数据（如数据库、网站文件等），可以与其他系统目录分离管理（<code>/var</code>，<code>/home</code> 等）</li></ul><p>创建挂载点</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="临时挂载" tabindex="-1"><a class="header-anchor" href="#临时挂载"><span>临时挂载</span></a></h2><blockquote><p>临时挂载，重启后，磁盘会丢失</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/nvme0n2p1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>可以看见，磁盘正确挂载到了 <code>/data</code> 下</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:~$ sudo lsblk</span></span>\n<span class="line"><span>[sudo] password for jojo:</span></span>\n<span class="line"><span>NAME                      MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span></span>\n<span class="line"><span>...</span></span>\n<span class="line"><span>nvme0n1                   259:0    0    70G  0 disk</span></span>\n<span class="line"><span>├─nvme0n1p1               259:1    0     1G  0 part /boot/efi</span></span>\n<span class="line"><span>├─nvme0n1p2               259:2    0     2G  0 part /boot</span></span>\n<span class="line"><span>└─nvme0n1p3               259:3    0  66.9G  0 part</span></span>\n<span class="line"><span>  └─ubuntu--vg-ubuntu--lv 252:0    0  33.5G  0 lvm  /</span></span>\n<span class="line"><span>nvme0n2                   259:4    0     8G  0 disk</span></span>\n<span class="line"><span>└─nvme0n2p1               259:5    0     8G  0 part /data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="永久挂载-开机自动挂载" tabindex="-1"><a class="header-anchor" href="#永久挂载-开机自动挂载"><span>永久挂载 - 开机自动挂载</span></a></h2><p>查看分区 UUID</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blkid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/nvme0n2p1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>jojo@jojo-server:/$ sudo blkid /dev/nvme0n2p1</span></span>\n<span class="line"><span>/dev/nvme0n2p1: UUID=&quot;9d763068-69d8-43f5-a334-87b289d0de9d&quot; BLOCK_SIZE=&quot;4096&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;856280d1-01&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>编辑 <code>/etc/fstab</code><code>fstab</code> (File System Table​​)，文件系统表。是 Linux 和类 Unix 系统中用于定义文件系统静态挂载信息的配置文件</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/fstab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># /etc/fstab: static file system information.</span></span>\n<span class="line"><span>#</span></span>\n<span class="line"><span># Use &#39;blkid&#39; to print the universally unique identifier for a</span></span>\n<span class="line"><span># device; this may be used with UUID= as a more robust way to name devices</span></span>\n<span class="line"><span># that works even if disks are added and removed. See fstab(5).</span></span>\n<span class="line"><span>#</span></span>\n<span class="line"><span># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span></span>\n<span class="line"><span># / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation</span></span>\n<span class="line"><span>/dev/disk/by-id/dm-uuid-LVM-BUVafIePHpGqGeBycUcQcakhlqK5FjiG1KC2dIxrIhiEtFpoC9ulh6uisICrW0dP / ext4 defaults 0 1</span></span>\n<span class="line"><span># /boot was on /dev/nvme0n1p2 during curtin installation</span></span>\n<span class="line"><span>/dev/disk/by-uuid/090863de-d515-4c0c-a593-7cc1685587c6 /boot ext4 defaults 0 1</span></span>\n<span class="line"><span># /boot/efi was on /dev/nvme0n1p1 during curtin installation</span></span>\n<span class="line"><span>/dev/disk/by-uuid/D591-D276 /boot/efi vfat defaults 0 1</span></span>\n<span class="line"><span>/swap.img       none    swap    sw      0       0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我就加了一行在文件最后面</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>UUID=9d763068-69d8-43f5-a334-87b289d0de9d /data ext4 defaults 0 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="关于-fstab-挂载的一些参数" tabindex="-1"><a class="header-anchor" href="#关于-fstab-挂载的一些参数"><span>关于 fstab 挂载的一些参数</span></a></h3><p>能看到格式提示：<code>&lt;file system&gt; &lt;mount point&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;</code></p><p><code>&lt;file system&gt;</code>​​ 指定要挂载的设备或文件系统，支持以下形式：</p><ul><li>​<strong>​设备路径​</strong>​：如 <code>/dev/sda1</code>，这个方式可能因磁盘顺序变化失效，或设备改名失效</li><li>​<strong>​UUID​</strong>​：如 <code>UUID=xxxx-xxxx</code>（推荐，唯一标识符，通过 <code>blkid</code> 命令获取）。如果是挂载云盘上的磁盘或分区，应使用 UUID！</li><li>​<strong>​标签（LABEL）​</strong>​：如 <code>LABEL=Data</code>（需预先通过 <code>e2label</code> 设置）</li><li>​<strong>​远程文件系统​</strong>​：如 <code>NFS</code> 格式 <code>host:/path</code></li></ul><p><code>&lt;mount point&gt;</code> 文件系统的挂载目标目录，需确保目录已存在</p><ul><li>​<strong>​交换分区（swap）​</strong>​：填写 <code>none</code></li><li>​<strong>​空格路径​</strong>​：用 <code>\\040</code> 替代空格（如 <code>/mnt/disk\\040one</code>）</li></ul><p><code>&lt;type&gt;</code> 文件系统类型，常见值包括：</p><ul><li><code>ext4</code>/<code>xfs</code>（Linux）、<code>ntfs</code>/<code>vfat</code>（Windows）、<code>swap</code>（交换分区）、<code>nfs</code>（网络存储）</li><li><code>auto</code>：自动检测类型（适用于移动设备）</li></ul><p><code>&lt;options&gt;</code> 挂载参数，多个参数用逗号分隔：</p><ul><li>​<strong>​基础选项​</strong>​：<br><code>defaults</code>（等效于 <code>rw,suid,dev,exec,auto,nouser,async</code>）。 <code>ro</code>（只读）、<code>rw</code>（读写）、<code>noexec</code>（禁止执行二进制文件）</li><li>​<strong>​性能优化​</strong>​：<br><code>noatime</code>（不更新访问时间）、<code>nodiratime</code>（不更新目录访问时间）</li><li>​<strong>​用户权限​</strong>​：<br><code>user</code>（允许普通用户挂载）、<code>nouser</code>（仅限 root）</li></ul><p><code>&lt;dump&gt;</code> 控制 <code>dump</code> 备份工具的备份频率：</p><ul><li><code>0</code>：不备份（默认）</li><li><code>1</code>：每天备份（仅对 <code>ext2/3/4</code> 有效）</li></ul><p><code>&lt;pass&gt;</code> 定义 <code>fsck</code> 磁盘检查顺序：</p><ul><li><code>0</code>：不检查。</li><li><code>1</code>：优先检查（通常用于根分区 <code>/</code>）</li><li><code>2</code>：次要检查（其他分区，按数字顺序执行） ps：<code>fsck</code>（File System Consistency Check）是 Linux/Unix 系统中用于​<strong>​检查和修复文件系统错误​</strong>​的工具</li></ul><h3 id="验证自动挂载" tabindex="-1"><a class="header-anchor" href="#验证自动挂载"><span>验证自动挂载</span></a></h3><p>重启，再执行一次 <code>sudo lsblk</code> 观察</p>',68)]))}]]),d=JSON.parse('{"path":"/posts/linux/Linux%20%E6%8C%82%E8%BD%BD%E6%96%B0%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9.html","title":"Linux 挂载新磁盘扩容","lang":"zh-CN","frontmatter":{"title":"Linux 挂载新磁盘扩容","date":"2025-05-04T00:00:00.000Z","category":["linux"],"tag":["linux"],"star":true,"sticky":false,"excerpt":"<p>我给 Ubuntu 添加了一块 8G 的硬盘，但新添加的硬盘还不能直接使用，还需要将硬盘进行初始化操作。初始化操作通常包含以下步骤</p>"},"headers":[{"level":2,"title":"确认新设备存在","slug":"确认新设备存在","link":"#确认新设备存在","children":[]},{"level":2,"title":"分区 - 针对 2TB 以内的硬盘 (MBR分区)","slug":"分区-针对-2tb-以内的硬盘-mbr分区","link":"#分区-针对-2tb-以内的硬盘-mbr分区","children":[]},{"level":2,"title":"分区 - 针对＞2TB的硬盘 (GPT分区)","slug":"分区-针对-2tb的硬盘-gpt分区","link":"#分区-针对-2tb的硬盘-gpt分区","children":[]},{"level":2,"title":"格式化分区","slug":"格式化分区","link":"#格式化分区","children":[]},{"level":2,"title":"挂载与开机自动加载","slug":"挂载与开机自动加载","link":"#挂载与开机自动加载","children":[]},{"level":2,"title":"临时挂载","slug":"临时挂载","link":"#临时挂载","children":[]},{"level":2,"title":"永久挂载 - 开机自动挂载","slug":"永久挂载-开机自动挂载","link":"#永久挂载-开机自动挂载","children":[{"level":3,"title":"关于 fstab 挂载的一些参数","slug":"关于-fstab-挂载的一些参数","link":"#关于-fstab-挂载的一些参数","children":[]},{"level":3,"title":"验证自动挂载","slug":"验证自动挂载","link":"#验证自动挂载","children":[]}]}],"git":{"createdTime":1746353372000,"updatedTime":1751537172000,"contributors":[{"name":"chenjjiaa","email":"1229282086@qq.com","commits":2}]},"readingTime":{"minutes":6.94,"words":2082},"filePathRelative":"posts/linux/Linux 挂载新磁盘扩容.md","localizedDate":"2025年5月4日"}')}}]);